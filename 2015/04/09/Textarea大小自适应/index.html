<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="author" content="Gary">
  
  <meta name="description" content="Title: Textarea大小自适应
Date: 2012-05-02 11:49:49
URL: /textarea-size-auto-adaptation/
Tags: textarea , 前端技术 , 大小自适应 , 自适应
很久很久以前，七宝帮远在英国的肉肉同学重构一个网页，网页上有">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Hexo"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Hexo</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-09T11:13:25.000Z"><a href="/2015/04/09/Textarea大小自适应/">2015-04-09</a></time>
      
      
  
    <h1 class="title"></h1>
  

    </header>
    <div class="entry">
      
        <p>Title: Textarea大小自适应</p>
<p>Date: 2012-05-02 11:49:49</p>
<p>URL: /textarea-size-auto-adaptation/</p>
<p>Tags: textarea , 前端技术 , 大小自适应 , 自适应</p>
<p>很久很久以前，七宝帮远在英国的肉肉同学重构一个网页，网页上有个留言的textarea。</p>
<p>由此她给我提了一个页面的问题：如何让一个textarea的大小根据内容来自动变大呢，类似微博那种。</p>
<p>当时研究了一下，原本的思路是计算单个文字大小高度，然后算有多少行然后调整高度。发现有兼容性问题，而且也比较麻烦。</p>
<p>昨天彻底的研究了一下，换了一个思路。因为DOM中，scrollHeight这个属性，可以取到该元素实际内容的高度，这样，就可以直接把textarea高度设置成scrollHeight就行了。方法简单了许多。最近在做模块化的东西，很想脱离jQuery的束缚，所以这次全部用DOM操作，做成了独立的一个js。</p>
<p>适用于主流浏览器，自测ie7/8/9,FireFox 10,Chrome 20.0.1096.1 通过。</p>
<p>Demo<a href="/lab/autotextarea/autotextarea.html" title="autoTextarea Demo">在此</a></p>
<p>以下是相关代码</p>
<p>autoTextarea.js:</p>
<pre><code><span class="keyword">var</span> autoTextarea = <span class="function"><span class="keyword">function</span> <span class="params">(elem)</span>
</span>{
    elem.style.resize = <span class="string">'none'</span>;

    minHeight = elem.currentStyle ?
        <span class="built_in">parseFloat</span>(elem.currentStyle[<span class="string">'height'</span>]) : <span class="built_in">parseFloat</span>(<span class="built_in">document</span>.defaultView.getComputedStyle(elem, <span class="literal">null</span>)[<span class="string">'height'</span>]);

    <span class="keyword">var</span> adjust = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
        <span class="keyword">if</span> (elem._length === elem.value.length) <span class="keyword">return</span>;
        elem._length = elem.value.length;

        elem.style.height = minHeight + <span class="string">'px'</span>;
        <span class="keyword">if</span> (elem.scrollHeight &gt; minHeight)
        {
            elem.style.overflowY = <span class="string">'hidden'</span>;
            elem.style.height = elem.scrollHeight + <span class="string">'px'</span>;
        }

    };

    addEvent = <span class="function"><span class="keyword">function</span> <span class="params">(type, callback)</span> </span>{
        elem.addEventListener ?
            elem.addEventListener(type, callback, <span class="literal">false</span>) :
            elem.attachEvent(<span class="string">'on'</span> + type, callback);
    };

    addEvent(<span class="string">'keydown'</span>, adjust);
    addEvent(<span class="string">'keyup'</span>, adjust);
    addEvent(<span class="string">'propertyadjust'</span>, adjust);
    addEvent(<span class="string">'input'</span>, adjust);
    addEvent(<span class="string">'focus'</span>, adjust);
    adjust();
};
</code></pre><p>autoTextarea.html:</p>
<pre><code><span class="tag">&lt;<span class="title">html</span>&gt;</span>
<span class="tag">&lt;<span class="title">head</span>&gt;</span>
    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">http-equiv</span>=<span class="value">"Content-Type"</span> <span class="attribute">content</span>=<span class="value">"text/html; charset=utf-8"</span> /&gt;</span>
    <span class="tag">&lt;<span class="title">title</span>&gt;</span>文本框自适应<span class="tag">&lt;/<span class="title">title</span>&gt;</span>
    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"autoTextarea.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
    <span class="tag">&lt;<span class="title">style</span> <span class="attribute">type</span>=<span class="value">"text/css"</span>&gt;</span><span class="css">
        <span class="id">#textarea</span> <span class="rules">{
            <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">200px</span></span></span>;
            <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100px</span></span></span>;
            <span class="rule"><span class="attribute">overflow-y</span>:<span class="value"> hidden</span></span>;
            <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">1px</span> solid <span class="hexcolor">#000</span></span></span>;
        }</span>
    </span><span class="tag">&lt;/<span class="title">style</span>&gt;</span>
<span class="tag">&lt;/<span class="title">head</span>&gt;</span>

<span class="tag">&lt;<span class="title">body</span>&gt;</span>
    <span class="tag">&lt;<span class="title">h2</span>&gt;</span>请在下面的输入框输入内容测试自适应<span class="tag">&lt;/<span class="title">h2</span>&gt;</span>
    <span class="tag">&lt;<span class="title">textarea</span> <span class="attribute">id</span>=<span class="value">"textarea"</span>&gt;</span><span class="tag">&lt;/<span class="title">textarea</span>&gt;</span>

    <span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="applescript">
        var <span class="type">text</span> = document.getElementById(<span class="string">"textarea"</span>);
        autoTextarea(<span class="type">text</span>);
    </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</code></pre>
      
    </div>
    <footer>
      
        
        
        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789012345";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="http://zgr0629.github.io/2015/04/09/Textarea大小自适应/index.html" data-num-posts="5" data-width="840" data-colorscheme="light"></div>
      
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜尋">
    <input type="hidden" name="q" value="site:zgr0629.github.io">
  </form>
</div>

  

  
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 Gary
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>